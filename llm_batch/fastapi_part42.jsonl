{"custom_id": "fastapi#39766d0f96d3bb80b3b0d2f3543f37027ac93cbf", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 1 | Lines Deleted: 1 | Files Changed: 1 | Hunks: 1 | Methods Changed: 1 | Complexity Δ (Sum/Max): 0/0 | Churn Δ: 2 | Churn Cumulative: 2145 | Contributors (this commit): 17 | Commits (past 90d): 6 | Contributors (cumulative): 17 | DMM Complexity: None\n\nDIFF:\n@@ -80,7 +80,7 @@ class FastAPI(Starlette):\n                 '\"openapi_prefix\" has been deprecated in favor of \"root_path\", which '\n                 \"follows more closely the ASGI standard, is simpler, and more \"\n                 \"automatic. Check the docs at \"\n-                \"https://fastapi.tiangolo.com/advanced/sub-applications-proxy/\"\n+                \"https://fastapi.tiangolo.com/advanced/sub-applications/\"\n             )\n         self.root_path = root_path or openapi_prefix\n         self.docs_url = docs_url\n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#3ff504f03fb5ba852def5a0a41653c6bed7efb1b", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 1 | Lines Deleted: 1 | Files Changed: 1 | Hunks: 1 | Methods Changed: 0 | Complexity Δ (Sum/Max): 0/0 | Churn Δ: 2 | Churn Cumulative: 253 | Contributors (this commit): 1 | Commits (past 90d): 10 | Contributors (cumulative): 1 | DMM Complexity: None\n\nDIFF:\n@@ -1,6 +1,6 @@\n \"\"\"FastAPI framework, high performance, easy to learn, fast to code, ready for production\"\"\"\n \n-__version__ = \"0.58.0\"\n+__version__ = \"0.58.1\"\n \n from starlette import status\n \n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#fe453f80eddea2ffdb87537a6be2cdd686db84c8", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 96 | Lines Deleted: 98 | Files Changed: 92 | Hunks: 95 | Methods Changed: 0 | Complexity Δ (Sum/Max): 4/4 | Churn Δ: 194 | Churn Cumulative: 11771 | Contributors (this commit): 38 | Commits (past 90d): 115 | Contributors (cumulative): 335 | DMM Complexity: None\n\nDIFF:\n@@ -1,11 +1,10 @@\n from typing import Optional\n \n-from fastapi import FastAPI\n-from pydantic import BaseModel\n-\n from couchbase import LOCKMODE_WAIT\n from couchbase.bucket import Bucket\n from couchbase.cluster import Cluster, PasswordAuthenticator\n+from fastapi import FastAPI\n+from pydantic import BaseModel\n \n USERPROFILE_DOC_TYPE = \"userprofile\"\n \n\n@@ -60,9 +60,9 @@ try:\n     from pydantic.typing import ForwardRef, evaluate_forwardref\n except ImportError:  # pragma: nocover\n     # TODO: remove when removing support for Pydantic < 1.0.0\n+    from pydantic import Schema as FieldInfo  # type: ignore\n     from pydantic.fields import Field as ModelField  # type: ignore\n     from pydantic.fields import Required, Shape  # type: ignore\n-    from pydantic import Schema as FieldInfo  # type: ignore\n     from pydantic.schema import get_annotation_from_schema  # type: ignore\n     from pydantic.utils import ForwardRef, evaluate_forwardref  # type: ignore\n \n\n@@ -3,10 +3,8 @@ from base64 import b64decode\n from typing import Optional\n \n from fastapi.exceptions import HTTPException\n-from fastapi.openapi.models import (\n-    HTTPBase as HTTPBaseModel,\n-    HTTPBearer as HTTPBearerModel,\n-)\n+from fastapi.openapi.models import HTTPBase as HTTPBaseModel\n+from fastapi.openapi.models import HTTPBearer as HTTPBearerModel\n from fastapi.security.base import SecurityBase\n from fastapi.security.utils import get_authorization_scheme_param\n from pydantic import BaseModel\n\n@@ -1,7 +1,8 @@\n from typing import List, Optional\n \n from fastapi.exceptions import HTTPException\n-from fastapi.openapi.models import OAuth2 as OAuth2Model, OAuthFlows as OAuthFlowsModel\n+from fastapi.openapi.models import OAuth2 as OAuth2Model\n+from fastapi.openapi.models import OAuthFlows as OAuthFlowsModel\n from fastapi.param_functions import Form\n from fastapi.security.base import SecurityBase\n from fastapi.security.utils import get_authorization_scheme_param\n\n@@ -18,8 +18,8 @@ try:\n     PYDANTIC_1 = True\n except ImportError:  # pragma: nocover\n     # TODO: remove when removing support for Pydantic < 1.0.0\n-    from pydantic.fields import Field as ModelField  # type: ignore\n     from pydantic import Schema as FieldInfo  # type: ignore\n+    from pydantic.fields import Field as ModelField  # type: ignore\n \n     class UndefinedType:  # type: ignore\n         def __repr__(self) -> str:\n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from additional_responses.tutorial001 import app\n+from docs_src.additional_responses.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -3,7 +3,7 @@ import shutil\n \n from fastapi.testclient import TestClient\n \n-from additional_responses.tutorial002 import app\n+from docs_src.additional_responses.tutorial002 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from additional_responses.tutorial003 import app\n+from docs_src.additional_responses.tutorial003 import app\n \n client = TestClient(app)\n \n\n@@ -3,7 +3,7 @@ import shutil\n \n from fastapi.testclient import TestClient\n \n-from additional_responses.tutorial004 import app\n+from docs_src.additional_responses.tutorial004 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from additional_status_codes.tutorial001 import app\n+from docs_src.additional_status_codes.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from advanced_middleware.tutorial001 import app\n+from docs_src.advanced_middleware.tutorial001 import app\n \n \n def test_middleware():\n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from advanced_middleware.tutorial002 import app\n+from docs_src.advanced_middleware.tutorial002 import app\n \n \n def test_middleware():\n\n@@ -1,7 +1,7 @@\n from fastapi.responses import PlainTextResponse\n from fastapi.testclient import TestClient\n \n-from advanced_middleware.tutorial003 import app\n+from docs_src.advanced_middleware.tutorial003 import app\n \n \n @app.get(\"/large\")\n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from async_sql_databases.tutorial001 import app\n+from docs_src.async_sql_databases.tutorial001 import app\n \n openapi_schema = {\n     \"openapi\": \"3.0.2\",\n\n@@ -3,7 +3,7 @@ from pathlib import Path\n \n from fastapi.testclient import TestClient\n \n-from background_tasks.tutorial001 import app\n+from docs_src.background_tasks.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -3,7 +3,7 @@ from pathlib import Path\n \n from fastapi.testclient import TestClient\n \n-from background_tasks.tutorial002 import app\n+from docs_src.background_tasks.tutorial002 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from behind_a_proxy.tutorial001 import app\n+from docs_src.behind_a_proxy.tutorial001 import app\n \n client = TestClient(app, root_path=\"/api/v1\")\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from behind_a_proxy.tutorial002 import app\n+from docs_src.behind_a_proxy.tutorial002 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from bigger_applications.app.main import app\n+from docs_src.bigger_applications.app.main import app\n \n client = TestClient(app)\n \n\n@@ -3,7 +3,7 @@ from unittest.mock import patch\n import pytest\n from fastapi.testclient import TestClient\n \n-from body.tutorial001 import app\n+from docs_src.body.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from body_fields.tutorial001 import app\n+from docs_src.body_fields.tutorial001 import app\n \n # TODO: remove when removing support for Pydantic < 1.0.0\n try:\n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from body_multiple_params.tutorial001 import app\n+from docs_src.body_multiple_params.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from body_multiple_params.tutorial003 import app\n+from docs_src.body_multiple_params.tutorial003 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from body_nested_models.tutorial009 import app\n+from docs_src.body_nested_models.tutorial009 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from body_updates.tutorial001 import app\n+from docs_src.body_updates.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -2,7 +2,7 @@ import importlib\n \n from fastapi.testclient import TestClient\n \n-from conditional_openapi import tutorial001\n+from docs_src.conditional_openapi import tutorial001\n \n openapi_schema = {\n     \"openapi\": \"3.0.2\",\n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from cookie_params.tutorial001 import app\n+from docs_src.cookie_params.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from cors.tutorial001 import app\n+from docs_src.cors.tutorial001 import app\n \n \n def test_cors():\n\n@@ -5,7 +5,7 @@ import pytest\n from fastapi import Request\n from fastapi.testclient import TestClient\n \n-from custom_request_and_route.tutorial001 import app\n+from docs_src.custom_request_and_route.tutorial001 import app\n \n \n @app.get(\"/check-class\")\n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from custom_request_and_route.tutorial002 import app\n+from docs_src.custom_request_and_route.tutorial002 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from custom_request_and_route.tutorial003 import app\n+from docs_src.custom_request_and_route.tutorial003 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from custom_response.tutorial001b import app\n+from docs_src.custom_response.tutorial001b import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from custom_response.tutorial004 import app\n+from docs_src.custom_response.tutorial004 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from custom_response.tutorial005 import app\n+from docs_src.custom_response.tutorial005 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from custom_response.tutorial006 import app\n+from docs_src.custom_response.tutorial006 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from custom_response.tutorial007 import app\n+from docs_src.custom_response.tutorial007 import app\n \n client = TestClient(app)\n \n\n@@ -2,8 +2,8 @@ from pathlib import Path\n \n from fastapi.testclient import TestClient\n \n-from custom_response import tutorial008\n-from custom_response.tutorial008 import app\n+from docs_src.custom_response import tutorial008\n+from docs_src.custom_response.tutorial008 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from dependencies.tutorial001 import app\n+from docs_src.dependencies.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from dependencies.tutorial004 import app\n+from docs_src.dependencies.tutorial004 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from dependencies.tutorial006 import app\n+from docs_src.dependencies.tutorial006 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from events.tutorial001 import app\n+from docs_src.events.tutorial001 import app\n \n openapi_schema = {\n     \"openapi\": \"3.0.2\",\n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from events.tutorial002 import app\n+from docs_src.events.tutorial002 import app\n \n openapi_schema = {\n     \"openapi\": \"3.0.2\",\n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from extending_openapi.tutorial001 import app\n+from docs_src.extending_openapi.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from extra_data_types.tutorial001 import app\n+from docs_src.extra_data_types.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from extra_models.tutorial003 import app\n+from docs_src.extra_models.tutorial003 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from extra_models.tutorial004 import app\n+from docs_src.extra_models.tutorial004 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from extra_models.tutorial005 import app\n+from docs_src.extra_models.tutorial005 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from first_steps.tutorial001 import app\n+from docs_src.first_steps.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from handling_errors.tutorial001 import app\n+from docs_src.handling_errors.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from handling_errors.tutorial002 import app\n+from docs_src.handling_errors.tutorial002 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from handling_errors.tutorial003 import app\n+from docs_src.handling_errors.tutorial003 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from handling_errors.tutorial004 import app\n+from docs_src.handling_errors.tutorial004 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from handling_errors.tutorial005 import app\n+from docs_src.handling_errors.tutorial005 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from handling_errors.tutorial006 import app\n+from docs_src.handling_errors.tutorial006 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from header_params.tutorial001 import app\n+from docs_src.header_params.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from metadata.tutorial001 import app\n+from docs_src.metadata.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from metadata.tutorial004 import app\n+from docs_src.metadata.tutorial004 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from openapi_callbacks.tutorial001 import app, invoice_notification\n+from docs_src.openapi_callbacks.tutorial001 import app, invoice_notification\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from path_operation_advanced_configuration.tutorial001 import app\n+from docs_src.path_operation_advanced_configuration.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from path_operation_advanced_configuration.tutorial002 import app\n+from docs_src.path_operation_advanced_configuration.tutorial002 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from path_operation_advanced_configuration.tutorial003 import app\n+from docs_src.path_operation_advanced_configuration.tutorial003 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from path_operation_advanced_configuration.tutorial004 import app\n+from docs_src.path_operation_advanced_configuration.tutorial004 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from path_operation_configuration.tutorial005 import app\n+from docs_src.path_operation_configuration.tutorial005 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from path_operation_configuration.tutorial006 import app\n+from docs_src.path_operation_configuration.tutorial006 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from path_params.tutorial004 import app\n+from docs_src.path_params.tutorial004 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from path_params.tutorial005 import app\n+from docs_src.path_params.tutorial005 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from query_params.tutorial005 import app\n+from docs_src.query_params.tutorial005 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from query_params.tutorial006 import app\n+from docs_src.query_params.tutorial006 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from query_params_str_validations.tutorial010 import app\n+from docs_src.query_params_str_validations.tutorial010 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from query_params_str_validations.tutorial011 import app\n+from docs_src.query_params_str_validations.tutorial011 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from query_params_str_validations.tutorial012 import app\n+from docs_src.query_params_str_validations.tutorial012 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from query_params_str_validations.tutorial013 import app\n+from docs_src.query_params_str_validations.tutorial013 import app\n \n client = TestClient(app)\n \n\n@@ -2,7 +2,7 @@ import os\n \n from fastapi.testclient import TestClient\n \n-from request_files.tutorial001 import app\n+from docs_src.request_files.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -2,7 +2,7 @@ import os\n \n from fastapi.testclient import TestClient\n \n-from request_files.tutorial002 import app\n+from docs_src.request_files.tutorial002 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from request_forms.tutorial001 import app\n+from docs_src.request_forms.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -3,7 +3,7 @@ from pathlib import Path\n \n from fastapi.testclient import TestClient\n \n-from request_forms_and_files.tutorial001 import app\n+from docs_src.request_forms_and_files.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from response_change_status_code.tutorial001 import app\n+from docs_src.response_change_status_code.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from response_cookies.tutorial001 import app\n+from docs_src.response_cookies.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from response_cookies.tutorial002 import app\n+from docs_src.response_cookies.tutorial002 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from response_headers.tutorial001 import app\n+from docs_src.response_headers.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from response_headers.tutorial002 import app\n+from docs_src.response_headers.tutorial002 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from response_model.tutorial003 import app\n+from docs_src.response_model.tutorial003 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,7 @@\n import pytest\n from fastapi.testclient import TestClient\n \n-from response_model.tutorial004 import app\n+from docs_src.response_model.tutorial004 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from response_model.tutorial005 import app\n+from docs_src.response_model.tutorial005 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from response_model.tutorial006 import app\n+from docs_src.response_model.tutorial006 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from security.tutorial001 import app\n+from docs_src.security.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from security.tutorial003 import app\n+from docs_src.security.tutorial003 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from security.tutorial005 import (\n+from docs_src.security.tutorial005 import (\n     app,\n     create_access_token,\n     fake_users_db,\n\n@@ -3,7 +3,7 @@ from base64 import b64encode\n from fastapi.testclient import TestClient\n from requests.auth import HTTPBasicAuth\n \n-from security.tutorial006 import app\n+from docs_src.security.tutorial006 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from settings.app02 import main, test_main\n+from docs_src.settings.app02 import main, test_main\n \n client = TestClient(main.app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from sub_applications.tutorial001 import app\n+from docs_src.sub_applications.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,6 +1,6 @@\n from fastapi.testclient import TestClient\n \n-from wsgi.tutorial001 import app\n+from docs_src.wsgi.tutorial001 import app\n \n client = TestClient(app)\n \n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#600f15faa0209704fdf02d69850ca4478b01b52a", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 20 | Lines Deleted: 13 | Files Changed: 13 | Hunks: 15 | Methods Changed: 6 | Complexity Δ (Sum/Max): 2/2 | Churn Δ: 33 | Churn Cumulative: 1755 | Contributors (this commit): 7 | Commits (past 90d): 14 | Contributors (cumulative): 32 | DMM Complexity: 1.0\n\nDIFF:\n@@ -10,7 +10,7 @@ def client():\n     static_dir: Path = Path(os.getcwd()) / \"static\"\n     print(static_dir)\n     static_dir.mkdir(exist_ok=True)\n-    from extending_openapi.tutorial002 import app\n+    from docs_src.extending_openapi.tutorial002 import app\n \n     with TestClient(app) as client:\n         yield client\n\n@@ -288,7 +288,7 @@ def client():\n     if test_db.is_file():  # pragma: nocover\n         test_db.unlink()\n     # Import while creating the client to create the DB after starting the test session\n-    from sql_databases.sql_app import main\n+    from docs_src.sql_databases.sql_app import main\n \n     # Ensure import side effects are re-executed\n     importlib.reload(main)\n\n@@ -288,7 +288,7 @@ def client():\n     if test_db.is_file():  # pragma: nocover\n         test_db.unlink()\n     # Import while creating the client to create the DB after starting the test session\n-    from sql_databases.sql_app import alt_main\n+    from docs_src.sql_databases.sql_app import alt_main\n \n     # Ensure import side effects are re-executed\n     importlib.reload(alt_main)\n\n@@ -7,7 +7,7 @@ def test_testing_dbs():\n     if test_db.is_file():  # pragma: nocover\n         test_db.unlink()\n     # Import while creating the client to create the DB after starting the test session\n-    from sql_databases.sql_app.tests import test_sql_app\n+    from docs_src.sql_databases.sql_app.tests import test_sql_app\n \n     # Ensure import side effects are re-executed\n     importlib.reload(test_sql_app)\n\n@@ -332,7 +332,7 @@ openapi_schema = {\n @pytest.fixture(scope=\"module\")\n def client():\n     # Import while creating the client to create the DB after starting the test session\n-    from sql_databases_peewee.sql_app.main import app\n+    from docs_src.sql_databases_peewee.sql_app.main import app\n \n     test_db = Path(\"./test.db\")\n     with TestClient(app) as c:\n\n@@ -1,12 +1,17 @@\n+import os\n import shutil\n \n from fastapi.testclient import TestClient\n \n \n def test_main():\n+    if os.path.isdir(\"./static\"):  # pragma: nocover\n+        shutil.rmtree(\"./static\")\n+    if os.path.isdir(\"./templates\"):  # pragma: nocover\n+        shutil.rmtree(\"./templates\")\n     shutil.copytree(\"./docs_src/templates/templates/\", \"./templates\")\n     shutil.copytree(\"./docs_src/templates/static/\", \"./static\")\n-    from templates.tutorial001 import app\n+    from docs_src.templates.tutorial001 import app\n \n     client = TestClient(app)\n     response = client.get(\"/items/foo\")\n\n@@ -1,4 +1,4 @@\n-from app_testing.test_main import client, test_read_main\n+from docs_src.app_testing.test_main import client, test_read_main\n \n openapi_schema = {\n     \"openapi\": \"3.0.2\",\n\n@@ -1,4 +1,4 @@\n-from app_testing.tutorial001 import client, test_read_main\n+from docs_src.app_testing.tutorial001 import client, test_read_main\n \n openapi_schema = {\n     \"openapi\": \"3.0.2\",\n\n@@ -1,4 +1,4 @@\n-from app_testing.tutorial002 import test_read_main, test_websocket\n+from docs_src.app_testing.tutorial002 import test_read_main, test_websocket\n \n \n def test_main():\n\n@@ -1,4 +1,4 @@\n-from app_testing.tutorial003 import test_read_items\n+from docs_src.app_testing.tutorial003 import test_read_items\n \n \n def test_main():\n\n@@ -1,4 +1,4 @@\n-from dependency_testing.tutorial001 import (\n+from docs_src.dependency_testing.tutorial001 import (\n     app,\n     client,\n     test_override_in_items,\n\n@@ -1,7 +1,8 @@\n import pytest\n from fastapi.testclient import TestClient\n from fastapi.websockets import WebSocketDisconnect\n-from websockets.tutorial001 import app\n+\n+from docs_src.websockets.tutorial001 import app\n \n client = TestClient(app)\n \n\n@@ -1,7 +1,8 @@\n import pytest\n from fastapi.testclient import TestClient\n from fastapi.websockets import WebSocketDisconnect\n-from websockets.tutorial002 import app\n+\n+from docs_src.websockets.tutorial002 import app\n \n client = TestClient(app)\n \n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#a5c03ba1b7468a52a6c7c5b62fd4a55840381598", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 9 | Lines Deleted: 4 | Files Changed: 1 | Hunks: 4 | Methods Changed: 3 | Complexity Δ (Sum/Max): 1/1 | Churn Δ: 13 | Churn Cumulative: 474 | Contributors (this commit): 2 | Commits (past 90d): 2 | Contributors (cumulative): 2 | DMM Complexity: 0.6666666666666666\n\nDIFF:\n@@ -132,6 +132,7 @@ def build_lang(\n         dist_path: Path = site_path / lang\n     shutil.rmtree(build_lang_path, ignore_errors=True)\n     shutil.copytree(lang_path, build_lang_path)\n+    shutil.copytree(en_docs_path / \"data\", build_lang_path / \"data\")\n     en_config_path: Path = en_lang_path / mkdocs_name\n     en_config: dict = mkdocs.utils.yaml_load(en_config_path.read_text(encoding=\"utf-8\"))\n     nav = en_config[\"nav\"]\n@@ -211,6 +212,12 @@ def build_all():\n     shutil.copyfile(en_index, \"README.md\")\n \n \n+def update_single_lang(lang: str):\n+    lang_path = docs_path / lang\n+    typer.echo(f\"Updating {lang_path.name}\")\n+    update_config(lang_path.name)\n+\n+\n @app.command()\n def update_languages(\n     lang: str = typer.Argument(\n@@ -226,11 +233,9 @@ def update_languages(\n     if lang is None:\n         for lang_path in get_lang_paths():\n             if lang_path.is_dir():\n-                typer.echo(f\"Updating {lang_path.name}\")\n-                update_config(lang_path.name)\n+                update_single_lang(lang_path.name)\n     else:\n-        typer.echo(f\"Updating {lang}\")\n-        update_config(lang)\n+        update_single_lang(lang)\n \n \n @app.command()\n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#70a51b3aff10afa4d6f0700da7e492273bd51b24", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 150 | Lines Deleted: 30 | Files Changed: 23 | Hunks: 38 | Methods Changed: 16 | Complexity Δ (Sum/Max): 16/6 | Churn Δ: 180 | Churn Cumulative: 5240 | Contributors (this commit): 30 | Commits (past 90d): 50 | Contributors (cumulative): 99 | DMM Complexity: 0.8461538461538461\n\nDIFF:\n@@ -0,0 +1,14 @@\n+from fastapi import FastAPI, Request\n+\n+app = FastAPI(\n+    servers=[\n+        {\"url\": \"https://stag.example.com\", \"description\": \"Staging environment\"},\n+        {\"url\": \"https://prod.example.com\", \"description\": \"Production environment\"},\n+    ],\n+    root_path=\"/api/v1\",\n+)\n+\n+\n+@app.get(\"/app\")\n+def read_main(request: Request):\n+    return {\"message\": \"Hello World\", \"root_path\": request.scope.get(\"root_path\")}\n\n@@ -0,0 +1,15 @@\n+from fastapi import FastAPI, Request\n+\n+app = FastAPI(\n+    servers=[\n+        {\"url\": \"https://stag.example.com\", \"description\": \"Staging environment\"},\n+        {\"url\": \"https://prod.example.com\", \"description\": \"Production environment\"},\n+    ],\n+    root_path=\"/api/v1\",\n+    root_path_in_servers=False,\n+)\n+\n+\n+@app.get(\"/app\")\n+def read_main(request: Request):\n+    return {\"message\": \"Hello World\", \"root_path\": request.scope.get(\"root_path\")}\n\n@@ -9,7 +9,7 @@ async def read_items():\n     return [{\"name\": \"Foo\"}]\n \n \n-def custom_openapi(openapi_prefix: str):\n+def custom_openapi():\n     if app.openapi_schema:\n         return app.openapi_schema\n     openapi_schema = get_openapi(\n@@ -17,7 +17,6 @@ def custom_openapi(openapi_prefix: str):\n         version=\"2.5.0\",\n         description=\"This is a very custom OpenAPI schema\",\n         routes=app.routes,\n-        openapi_prefix=openapi_prefix,\n     )\n     openapi_schema[\"info\"][\"x-logo\"] = {\n         \"url\": \"https://fastapi.tiangolo.com/img/logo-margin/logo-teal.png\"\n\n@@ -3,7 +3,7 @@ from fastapi.security import OAuth2PasswordBearer\n \n app = FastAPI()\n \n-oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"/token\")\n+oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"token\")\n \n \n @app.get(\"/items/\")\n\n@@ -6,7 +6,7 @@ from pydantic import BaseModel\n \n app = FastAPI()\n \n-oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"/token\")\n+oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"token\")\n \n \n class User(BaseModel):\n\n@@ -28,7 +28,7 @@ def fake_hash_password(password: str):\n     return \"fakehashed\" + password\n \n \n-oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"/token\")\n+oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"token\")\n \n \n class User(BaseModel):\n\n@@ -48,7 +48,7 @@ class UserInDB(User):\n \n pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")\n \n-oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"/token\")\n+oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"token\")\n \n app = FastAPI()\n \n\n@@ -61,7 +61,7 @@ class UserInDB(User):\n pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")\n \n oauth2_scheme = OAuth2PasswordBearer(\n-    tokenUrl=\"/token\",\n+    tokenUrl=\"token\",\n     scopes={\"me\": \"Read information about the current user.\", \"items\": \"Read items.\"},\n )\n \n\n@@ -50,6 +50,7 @@ class FastAPI(Starlette):\n         on_shutdown: Sequence[Callable] = None,\n         openapi_prefix: str = \"\",\n         root_path: str = \"\",\n+        root_path_in_servers: bool = True,\n         **extra: Dict[str, Any],\n     ) -> None:\n         self.default_response_class = default_response_class\n@@ -71,7 +72,7 @@ class FastAPI(Starlette):\n         self.title = title\n         self.description = description\n         self.version = version\n-        self.servers = servers\n+        self.servers = servers or []\n         self.openapi_url = openapi_url\n         self.openapi_tags = openapi_tags\n         # TODO: remove when discarding the openapi_prefix parameter\n@@ -83,6 +84,7 @@ class FastAPI(Starlette):\n                 \"https://fastapi.tiangolo.com/advanced/sub-applications/\"\n             )\n         self.root_path = root_path or openapi_prefix\n+        self.root_path_in_servers = root_path_in_servers\n         self.docs_url = docs_url\n         self.redoc_url = redoc_url\n         self.swagger_ui_oauth2_redirect_url = swagger_ui_oauth2_redirect_url\n@@ -98,7 +100,7 @@ class FastAPI(Starlette):\n         self.openapi_schema: Optional[Dict[str, Any]] = None\n         self.setup()\n \n-    def openapi(self, openapi_prefix: str = \"\") -> Dict:\n+    def openapi(self) -> Dict:\n         if not self.openapi_schema:\n             self.openapi_schema = get_openapi(\n                 title=self.title,\n@@ -106,7 +108,6 @@ class FastAPI(Starlette):\n                 openapi_version=self.openapi_version,\n                 description=self.description,\n                 routes=self.routes,\n-                openapi_prefix=openapi_prefix,\n                 tags=self.openapi_tags,\n                 servers=self.servers,\n             )\n@@ -114,10 +115,19 @@ class FastAPI(Starlette):\n \n     def setup(self) -> None:\n         if self.openapi_url:\n+            server_urls = set()\n+            for server_data in self.servers:\n+                url = server_data.get(\"url\")\n+                if url:\n+                    server_urls.add(url)\n \n             async def openapi(req: Request) -> JSONResponse:\n                 root_path = req.scope.get(\"root_path\", \"\").rstrip(\"/\")\n-                return JSONResponse(self.openapi(root_path))\n+                if root_path not in server_urls:\n+                    if root_path and self.root_path_in_servers:\n+                        self.servers.insert(0, {\"url\": root_path})\n+                        server_urls.add(root_path)\n+                return JSONResponse(self.openapi())\n \n             self.add_route(self.openapi_url, openapi, include_in_schema=False)\n         if self.openapi_url and self.docs_url:\n\n@@ -331,7 +331,6 @@ def get_openapi(\n     openapi_version: str = \"3.0.2\",\n     description: str = None,\n     routes: Sequence[BaseRoute],\n-    openapi_prefix: str = \"\",\n     tags: Optional[List[Dict[str, Any]]] = None,\n     servers: Optional[List[Dict[str, Union[str, Any]]]] = None,\n ) -> Dict:\n@@ -356,9 +355,7 @@ def get_openapi(\n             if result:\n                 path, security_schemes, path_definitions = result\n                 if path:\n-                    paths.setdefault(openapi_prefix + route.path_format, {}).update(\n-                        path\n-                    )\n+                    paths.setdefault(route.path_format, {}).update(path)\n                 if security_schemes:\n                     components.setdefault(\"securitySchemes\", {}).update(\n                         security_schemes\n\n@@ -31,7 +31,7 @@ def get_security(sec=Security(HTTPBasic())):\n reusable_oauth2 = OAuth2(\n     flows={\n         \"password\": {\n-            \"tokenUrl\": \"/token\",\n+            \"tokenUrl\": \"token\",\n             \"scopes\": {\"read:user\": \"Read a User\", \"write:user\": \"Create a user\"},\n         }\n     }\n\n@@ -15,7 +15,7 @@ openapi_schema = {\n     \"openapi\": \"3.0.2\",\n     \"info\": {\"title\": \"FastAPI\", \"version\": \"0.1.0\"},\n     \"paths\": {\n-        \"/api/v1/app\": {\n+        \"/app\": {\n             \"get\": {\n                 \"summary\": \"Read Main\",\n                 \"operationId\": \"read_main_app_get\",\n@@ -28,6 +28,7 @@ openapi_schema = {\n             }\n         }\n     },\n+    \"servers\": [{\"url\": \"/api/v1\"}],\n }\n \n \n\n@@ -9,7 +9,7 @@ app = FastAPI()\n reusable_oauth2 = OAuth2(\n     flows={\n         \"password\": {\n-            \"tokenUrl\": \"/token\",\n+            \"tokenUrl\": \"token\",\n             \"scopes\": {\"read:users\": \"Read the users\", \"write:users\": \"Create users\"},\n         }\n     }\n@@ -144,7 +144,7 @@ openapi_schema = {\n                             \"read:users\": \"Read the users\",\n                             \"write:users\": \"Create users\",\n                         },\n-                        \"tokenUrl\": \"/token\",\n+                        \"tokenUrl\": \"token\",\n                     }\n                 },\n             }\n\n@@ -7,7 +7,7 @@ from fastapi.testclient import TestClient\n app = FastAPI()\n \n oauth2_scheme = OAuth2AuthorizationCodeBearer(\n-    authorizationUrl=\"/authorize\", tokenUrl=\"/token\", auto_error=True\n+    authorizationUrl=\"authorize\", tokenUrl=\"token\", auto_error=True\n )\n \n \n@@ -42,8 +42,8 @@ openapi_schema = {\n                 \"type\": \"oauth2\",\n                 \"flows\": {\n                     \"authorizationCode\": {\n-                        \"authorizationUrl\": \"/authorize\",\n-                        \"tokenUrl\": \"/token\",\n+                        \"authorizationUrl\": \"authorize\",\n+                        \"tokenUrl\": \"token\",\n                         \"scopes\": {},\n                     }\n                 },\n\n@@ -11,7 +11,7 @@ app = FastAPI()\n reusable_oauth2 = OAuth2(\n     flows={\n         \"password\": {\n-            \"tokenUrl\": \"/token\",\n+            \"tokenUrl\": \"token\",\n             \"scopes\": {\"read:users\": \"Read the users\", \"write:users\": \"Create users\"},\n         }\n     },\n@@ -148,7 +148,7 @@ openapi_schema = {\n                             \"read:users\": \"Read the users\",\n                             \"write:users\": \"Create users\",\n                         },\n-                        \"tokenUrl\": \"/token\",\n+                        \"tokenUrl\": \"token\",\n                     }\n                 },\n             }\n\n@@ -8,7 +8,7 @@ openapi_schema = {\n     \"openapi\": \"3.0.2\",\n     \"info\": {\"title\": \"FastAPI\", \"version\": \"0.1.0\"},\n     \"paths\": {\n-        \"/api/v1/app\": {\n+        \"/app\": {\n             \"get\": {\n                 \"summary\": \"Read Main\",\n                 \"operationId\": \"read_main_app_get\",\n@@ -21,6 +21,7 @@ openapi_schema = {\n             }\n         }\n     },\n+    \"servers\": [{\"url\": \"/api/v1\"}],\n }\n \n \n\n@@ -8,7 +8,7 @@ openapi_schema = {\n     \"openapi\": \"3.0.2\",\n     \"info\": {\"title\": \"FastAPI\", \"version\": \"0.1.0\"},\n     \"paths\": {\n-        \"/api/v1/app\": {\n+        \"/app\": {\n             \"get\": {\n                 \"summary\": \"Read Main\",\n                 \"operationId\": \"read_main_app_get\",\n@@ -21,6 +21,7 @@ openapi_schema = {\n             }\n         }\n     },\n+    \"servers\": [{\"url\": \"/api/v1\"}],\n }\n \n \n\n@@ -0,0 +1,41 @@\n+from fastapi.testclient import TestClient\n+\n+from docs_src.behind_a_proxy.tutorial003 import app\n+\n+client = TestClient(app)\n+\n+openapi_schema = {\n+    \"openapi\": \"3.0.2\",\n+    \"info\": {\"title\": \"FastAPI\", \"version\": \"0.1.0\"},\n+    \"servers\": [\n+        {\"url\": \"/api/v1\"},\n+        {\"url\": \"https://stag.example.com\", \"description\": \"Staging environment\"},\n+        {\"url\": \"https://prod.example.com\", \"description\": \"Production environment\"},\n+    ],\n+    \"paths\": {\n+        \"/app\": {\n+            \"get\": {\n+                \"summary\": \"Read Main\",\n+                \"operationId\": \"read_main_app_get\",\n+                \"responses\": {\n+                    \"200\": {\n+                        \"description\": \"Successful Response\",\n+                        \"content\": {\"application/json\": {\"schema\": {}}},\n+                    }\n+                },\n+            }\n+        }\n+    },\n+}\n+\n+\n+def test_openapi():\n+    response = client.get(\"/openapi.json\")\n+    assert response.status_code == 200\n+    assert response.json() == openapi_schema\n+\n+\n+def test_main():\n+    response = client.get(\"/app\")\n+    assert response.status_code == 200\n+    assert response.json() == {\"message\": \"Hello World\", \"root_path\": \"/api/v1\"}\n\n@@ -0,0 +1,40 @@\n+from fastapi.testclient import TestClient\n+\n+from docs_src.behind_a_proxy.tutorial004 import app\n+\n+client = TestClient(app)\n+\n+openapi_schema = {\n+    \"openapi\": \"3.0.2\",\n+    \"info\": {\"title\": \"FastAPI\", \"version\": \"0.1.0\"},\n+    \"servers\": [\n+        {\"url\": \"https://stag.example.com\", \"description\": \"Staging environment\"},\n+        {\"url\": \"https://prod.example.com\", \"description\": \"Production environment\"},\n+    ],\n+    \"paths\": {\n+        \"/app\": {\n+            \"get\": {\n+                \"summary\": \"Read Main\",\n+                \"operationId\": \"read_main_app_get\",\n+                \"responses\": {\n+                    \"200\": {\n+                        \"description\": \"Successful Response\",\n+                        \"content\": {\"application/json\": {\"schema\": {}}},\n+                    }\n+                },\n+            }\n+        }\n+    },\n+}\n+\n+\n+def test_openapi():\n+    response = client.get(\"/openapi.json\")\n+    assert response.status_code == 200\n+    assert response.json() == openapi_schema\n+\n+\n+def test_main():\n+    response = client.get(\"/app\")\n+    assert response.status_code == 200\n+    assert response.json() == {\"message\": \"Hello World\", \"root_path\": \"/api/v1\"}\n\n@@ -26,7 +26,7 @@ openapi_schema = {\n         \"securitySchemes\": {\n             \"OAuth2PasswordBearer\": {\n                 \"type\": \"oauth2\",\n-                \"flows\": {\"password\": {\"scopes\": {}, \"tokenUrl\": \"/token\"}},\n+                \"flows\": {\"password\": {\"scopes\": {}, \"tokenUrl\": \"token\"}},\n             }\n         }\n     },\n\n@@ -102,7 +102,7 @@ openapi_schema = {\n         \"securitySchemes\": {\n             \"OAuth2PasswordBearer\": {\n                 \"type\": \"oauth2\",\n-                \"flows\": {\"password\": {\"scopes\": {}, \"tokenUrl\": \"/token\"}},\n+                \"flows\": {\"password\": {\"scopes\": {}, \"tokenUrl\": \"token\"}},\n             }\n         },\n     },\n\n@@ -168,7 +168,7 @@ openapi_schema = {\n                             \"me\": \"Read information about the current user.\",\n                             \"items\": \"Read items.\",\n                         },\n-                        \"tokenUrl\": \"/token\",\n+                        \"tokenUrl\": \"token\",\n                     }\n                 },\n             }\n\n@@ -26,7 +26,7 @@ openapi_schema_sub = {\n     \"openapi\": \"3.0.2\",\n     \"info\": {\"title\": \"FastAPI\", \"version\": \"0.1.0\"},\n     \"paths\": {\n-        \"/subapi/sub\": {\n+        \"/sub\": {\n             \"get\": {\n                 \"responses\": {\n                     \"200\": {\n@@ -39,6 +39,7 @@ openapi_schema_sub = {\n             }\n         }\n     },\n+    \"servers\": [{\"url\": \"/subapi\"}],\n }\n \n \n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#921642dc7b4c82735c9691d2c0cace25dc3e34d8", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 4 | Lines Deleted: 6 | Files Changed: 2 | Hunks: 6 | Methods Changed: 2 | Complexity Δ (Sum/Max): 0/0 | Churn Δ: 10 | Churn Cumulative: 41 | Contributors (this commit): 4 | Commits (past 90d): 8 | Contributors (cumulative): 8 | DMM Complexity: None\n\nDIFF:\n@@ -1,10 +1,9 @@\n from datetime import datetime, timedelta\n from typing import Optional\n \n-import jwt\n from fastapi import Depends, FastAPI, HTTPException, status\n from fastapi.security import OAuth2PasswordBearer, OAuth2PasswordRequestForm\n-from jwt import PyJWTError\n+from jose import JWTError, jwt\n from passlib.context import CryptContext\n from pydantic import BaseModel\n \n@@ -99,7 +98,7 @@ async def get_current_user(token: str = Depends(oauth2_scheme)):\n         if username is None:\n             raise credentials_exception\n         token_data = TokenData(username=username)\n-    except PyJWTError:\n+    except JWTError:\n         raise credentials_exception\n     user = get_user(fake_users_db, username=token_data.username)\n     if user is None:\n\n@@ -1,14 +1,13 @@\n from datetime import datetime, timedelta\n from typing import List, Optional\n \n-import jwt\n from fastapi import Depends, FastAPI, HTTPException, Security, status\n from fastapi.security import (\n     OAuth2PasswordBearer,\n     OAuth2PasswordRequestForm,\n     SecurityScopes,\n )\n-from jwt import PyJWTError\n+from jose import JWTError, jwt\n from passlib.context import CryptContext\n from pydantic import BaseModel, ValidationError\n \n@@ -121,7 +120,7 @@ async def get_current_user(\n             raise credentials_exception\n         token_scopes = payload.get(\"scopes\", [])\n         token_data = TokenData(scopes=token_scopes, username=username)\n-    except (PyJWTError, ValidationError):\n+    except (JWTError, ValidationError):\n         raise credentials_exception\n     user = get_user(fake_users_db, username=token_data.username)\n     if user is None:\n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#ff6afeaf78ef9864ed8987e0c5b6f0d127773413", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 2 | Lines Deleted: 2 | Files Changed: 1 | Hunks: 2 | Methods Changed: 0 | Complexity Δ (Sum/Max): 0/0 | Churn Δ: 4 | Churn Cumulative: 421 | Contributors (this commit): 5 | Commits (past 90d): 2 | Contributors (cumulative): 5 | DMM Complexity: None\n\nDIFF:\n@@ -15,7 +15,7 @@ class OAuth2PasswordRequestForm:\n     This is a dependency class, use it like:\n \n         @app.post(\"/login\")\n-        def login(form_data: Oauth2PasswordRequestForm = Depends()):\n+        def login(form_data: OAuth2PasswordRequestForm = Depends()):\n             data = form_data.parse()\n             print(data.username)\n             print(data.password)\n@@ -65,7 +65,7 @@ class OAuth2PasswordRequestFormStrict(OAuth2PasswordRequestForm):\n     This is a dependency class, use it like:\n \n         @app.post(\"/login\")\n-        def login(form_data: Oauth2PasswordRequestFormStrict = Depends()):\n+        def login(form_data: OAuth2PasswordRequestFormStrict = Depends()):\n             data = form_data.parse()\n             print(data.username)\n             print(data.password)\n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#d60dd1b60e0acd0afcd5688e5759f450b6e7340c", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 1 | Lines Deleted: 1 | Files Changed: 1 | Hunks: 1 | Methods Changed: 0 | Complexity Δ (Sum/Max): 0/0 | Churn Δ: 2 | Churn Cumulative: 255 | Contributors (this commit): 1 | Commits (past 90d): 9 | Contributors (cumulative): 1 | DMM Complexity: None\n\nDIFF:\n@@ -1,6 +1,6 @@\n \"\"\"FastAPI framework, high performance, easy to learn, fast to code, ready for production\"\"\"\n \n-__version__ = \"0.58.1\"\n+__version__ = \"0.59.0\"\n \n from starlette import status\n \n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#2b47f3e56b0b46d85be4ee4626e08741b5e69382", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 112 | Lines Deleted: 2 | Files Changed: 3 | Hunks: 3 | Methods Changed: 4 | Complexity Δ (Sum/Max): 3/3 | Churn Δ: 114 | Churn Cumulative: 1784 | Contributors (this commit): 19 | Commits (past 90d): 10 | Contributors (cumulative): 22 | DMM Complexity: 1.0\n\nDIFF:\n@@ -246,7 +246,9 @@ def get_typed_signature(call: Callable) -> inspect.Signature:\n def get_typed_annotation(param: inspect.Parameter, globalns: Dict[str, Any]) -> Any:\n     annotation = param.annotation\n     if isinstance(annotation, str):\n-        annotation = ForwardRef(annotation)\n+        # Temporary ignore type\n+        # Ref: https://github.com/samuelcolvin/pydantic/issues/1738\n+        annotation = ForwardRef(annotation)  # type: ignore\n         annotation = evaluate_forwardref(annotation, globalns, globalns)\n     return annotation\n \n\n@@ -1,3 +1,3 @@\n-METHODS_WITH_BODY = set((\"POST\", \"PUT\", \"DELETE\", \"PATCH\"))\n+METHODS_WITH_BODY = set((\"GET\", \"HEAD\", \"POST\", \"PUT\", \"DELETE\", \"PATCH\"))\n STATUS_CODES_WITH_NO_BODY = set((100, 101, 102, 103, 204, 304))\n REF_PREFIX = \"#/components/schemas/\"\n\n@@ -0,0 +1,108 @@\n+from fastapi import FastAPI\n+from fastapi.testclient import TestClient\n+from pydantic import BaseModel\n+\n+app = FastAPI()\n+\n+\n+class Product(BaseModel):\n+    name: str\n+    description: str = None\n+    price: float\n+\n+\n+@app.get(\"/product\")\n+async def create_item(product: Product):\n+    return product\n+\n+\n+client = TestClient(app)\n+\n+\n+openapi_schema = {\n+    \"openapi\": \"3.0.2\",\n+    \"info\": {\"title\": \"FastAPI\", \"version\": \"0.1.0\"},\n+    \"paths\": {\n+        \"/product\": {\n+            \"get\": {\n+                \"summary\": \"Create Item\",\n+                \"operationId\": \"create_item_product_get\",\n+                \"requestBody\": {\n+                    \"content\": {\n+                        \"application/json\": {\n+                            \"schema\": {\"$ref\": \"#/components/schemas/Product\"}\n+                        }\n+                    },\n+                    \"required\": True,\n+                },\n+                \"responses\": {\n+                    \"200\": {\n+                        \"description\": \"Successful Response\",\n+                        \"content\": {\"application/json\": {\"schema\": {}}},\n+                    },\n+                    \"422\": {\n+                        \"description\": \"Validation Error\",\n+                        \"content\": {\n+                            \"application/json\": {\n+                                \"schema\": {\n+                                    \"$ref\": \"#/components/schemas/HTTPValidationError\"\n+                                }\n+                            }\n+                        },\n+                    },\n+                },\n+            }\n+        }\n+    },\n+    \"components\": {\n+        \"schemas\": {\n+            \"HTTPValidationError\": {\n+                \"title\": \"HTTPValidationError\",\n+                \"type\": \"object\",\n+                \"properties\": {\n+                    \"detail\": {\n+                        \"title\": \"Detail\",\n+                        \"type\": \"array\",\n+                        \"items\": {\"$ref\": \"#/components/schemas/ValidationError\"},\n+                    }\n+                },\n+            },\n+            \"Product\": {\n+                \"title\": \"Product\",\n+                \"required\": [\"name\", \"price\"],\n+                \"type\": \"object\",\n+                \"properties\": {\n+                    \"name\": {\"title\": \"Name\", \"type\": \"string\"},\n+                    \"description\": {\"title\": \"Description\", \"type\": \"string\"},\n+                    \"price\": {\"title\": \"Price\", \"type\": \"number\"},\n+                },\n+            },\n+            \"ValidationError\": {\n+                \"title\": \"ValidationError\",\n+                \"required\": [\"loc\", \"msg\", \"type\"],\n+                \"type\": \"object\",\n+                \"properties\": {\n+                    \"loc\": {\n+                        \"title\": \"Location\",\n+                        \"type\": \"array\",\n+                        \"items\": {\"type\": \"string\"},\n+                    },\n+                    \"msg\": {\"title\": \"Message\", \"type\": \"string\"},\n+                    \"type\": {\"title\": \"Error Type\", \"type\": \"string\"},\n+                },\n+            },\n+        }\n+    },\n+}\n+\n+\n+def test_openapi_schema():\n+    response = client.get(\"/openapi.json\")\n+    assert response.status_code == 200, response.text\n+    assert response.json() == openapi_schema\n+\n+\n+def test_get_with_body():\n+    body = {\"name\": \"Foo\", \"description\": \"Some description\", \"price\": 5.5}\n+    response = client.get(\"/product\", json=body)\n+    assert response.json() == body\n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
