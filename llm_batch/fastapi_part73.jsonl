{"custom_id": "fastapi#09e4859cab3354dd17c5884806bbc5a1330380dd", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 129 | Lines Deleted: 3 | Files Changed: 5 | Hunks: 8 | Methods Changed: 9 | Complexity Δ (Sum/Max): 8/4 | Churn Δ: 132 | Churn Cumulative: 4658 | Contributors (this commit): 32 | Commits (past 90d): 8 | Contributors (cumulative): 57 | DMM Complexity: 0.981651376146789\n\nDIFF:\n@@ -24,7 +24,7 @@ from pydantic.networks import AnyUrl, NameEmail\n from pydantic.types import SecretBytes, SecretStr\n from typing_extensions import Annotated, Doc\n \n-from ._compat import PYDANTIC_V2, Url, _model_dump\n+from ._compat import PYDANTIC_V2, UndefinedType, Url, _model_dump\n \n \n # Taken from Pydantic v1 as is\n@@ -259,6 +259,8 @@ def jsonable_encoder(\n         return str(obj)\n     if isinstance(obj, (str, int, float, type(None))):\n         return obj\n+    if isinstance(obj, UndefinedType):\n+        return None\n     if isinstance(obj, dict):\n         encoded_dict = {}\n         allowed_keys = set(obj.keys())\n\n@@ -1,5 +1,5 @@\n import http\n-from typing import FrozenSet, Optional\n+from typing import FrozenSet, List, Optional\n \n from fastapi import FastAPI, Path, Query\n \n@@ -192,3 +192,13 @@ def get_enum_status_code():\n @app.get(\"/query/frozenset\")\n def get_query_type_frozenset(query: FrozenSet[int] = Query(...)):\n     return \",\".join(map(str, sorted(query)))\n+\n+\n+@app.get(\"/query/list\")\n+def get_query_list(device_ids: List[int] = Query()) -> List[int]:\n+    return device_ids\n+\n+\n+@app.get(\"/query/list-default\")\n+def get_query_list_default(device_ids: List[int] = Query(default=[])) -> List[int]:\n+    return device_ids\n\n@@ -1163,6 +1163,91 @@ def test_openapi_schema():\n                     },\n                 }\n             },\n+            \"/query/list\": {\n+                \"get\": {\n+                    \"summary\": \"Get Query List\",\n+                    \"operationId\": \"get_query_list_query_list_get\",\n+                    \"parameters\": [\n+                        {\n+                            \"name\": \"device_ids\",\n+                            \"in\": \"query\",\n+                            \"required\": True,\n+                            \"schema\": {\n+                                \"type\": \"array\",\n+                                \"items\": {\"type\": \"integer\"},\n+                                \"title\": \"Device Ids\",\n+                            },\n+                        }\n+                    ],\n+                    \"responses\": {\n+                        \"200\": {\n+                            \"description\": \"Successful Response\",\n+                            \"content\": {\n+                                \"application/json\": {\n+                                    \"schema\": {\n+                                        \"type\": \"array\",\n+                                        \"items\": {\"type\": \"integer\"},\n+                                        \"title\": \"Response Get Query List Query List Get\",\n+                                    }\n+                                }\n+                            },\n+                        },\n+                        \"422\": {\n+                            \"description\": \"Validation Error\",\n+                            \"content\": {\n+                                \"application/json\": {\n+                                    \"schema\": {\n+                                        \"$ref\": \"#/components/schemas/HTTPValidationError\"\n+                                    }\n+                                }\n+                            },\n+                        },\n+                    },\n+                }\n+            },\n+            \"/query/list-default\": {\n+                \"get\": {\n+                    \"summary\": \"Get Query List Default\",\n+                    \"operationId\": \"get_query_list_default_query_list_default_get\",\n+                    \"parameters\": [\n+                        {\n+                            \"name\": \"device_ids\",\n+                            \"in\": \"query\",\n+                            \"required\": False,\n+                            \"schema\": {\n+                                \"type\": \"array\",\n+                                \"items\": {\"type\": \"integer\"},\n+                                \"default\": [],\n+                                \"title\": \"Device Ids\",\n+                            },\n+                        }\n+                    ],\n+                    \"responses\": {\n+                        \"200\": {\n+                            \"description\": \"Successful Response\",\n+                            \"content\": {\n+                                \"application/json\": {\n+                                    \"schema\": {\n+                                        \"type\": \"array\",\n+                                        \"items\": {\"type\": \"integer\"},\n+                                        \"title\": \"Response Get Query List Default Query List Default Get\",\n+                                    }\n+                                }\n+                            },\n+                        },\n+                        \"422\": {\n+                            \"description\": \"Validation Error\",\n+                            \"content\": {\n+                                \"application/json\": {\n+                                    \"schema\": {\n+                                        \"$ref\": \"#/components/schemas/HTTPValidationError\"\n+                                    }\n+                                }\n+                            },\n+                        },\n+                    },\n+                }\n+            },\n         },\n         \"components\": {\n             \"schemas\": {\n\n@@ -7,7 +7,7 @@ from pathlib import PurePath, PurePosixPath, PureWindowsPath\n from typing import Optional\n \n import pytest\n-from fastapi._compat import PYDANTIC_V2\n+from fastapi._compat import PYDANTIC_V2, Undefined\n from fastapi.encoders import jsonable_encoder\n from pydantic import BaseModel, Field, ValidationError\n \n@@ -310,3 +310,9 @@ def test_encode_deque_encodes_child_models():\n     dq = deque([Model(test=\"test\")])\n \n     assert jsonable_encoder(dq)[0][\"test\"] == \"test\"\n+\n+\n+@needs_pydanticv2\n+def test_encode_pydantic_undefined():\n+    data = {\"value\": Undefined}\n+    assert jsonable_encoder(data) == {\"value\": None}\n\n@@ -396,3 +396,26 @@ def test_query_frozenset_query_1_query_1_query_2():\n     response = client.get(\"/query/frozenset/?query=1&query=1&query=2\")\n     assert response.status_code == 200\n     assert response.json() == \"1,2\"\n+\n+\n+def test_query_list():\n+    response = client.get(\"/query/list/?device_ids=1&device_ids=2\")\n+    assert response.status_code == 200\n+    assert response.json() == [1, 2]\n+\n+\n+def test_query_list_empty():\n+    response = client.get(\"/query/list/\")\n+    assert response.status_code == 422\n+\n+\n+def test_query_list_default():\n+    response = client.get(\"/query/list-default/?device_ids=1&device_ids=2\")\n+    assert response.status_code == 200\n+    assert response.json() == [1, 2]\n+\n+\n+def test_query_list_default_empty():\n+    response = client.get(\"/query/list-default/\")\n+    assert response.status_code == 200\n+    assert response.json() == []\n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#74cc33d16b70a910e6c3a2dcd8be586c2e6b66c4", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 32 | Lines Deleted: 198 | Files Changed: 1 | Hunks: 44 | Methods Changed: 0 | Complexity Δ (Sum/Max): 0/0 | Churn Δ: 230 | Churn Cumulative: 1365 | Contributors (this commit): 11 | Commits (past 90d): 1 | Contributors (cumulative): 11 | DMM Complexity: None\n\nDIFF:\n@@ -55,35 +55,29 @@ except ImportError:  # pragma: no cover\n             return with_info_plain_validator_function(cls._validate)\n \n \n-class Contact(BaseModel):\n+class BaseModelWithConfig(BaseModel):\n+    if PYDANTIC_V2:\n+        model_config = {\"extra\": \"allow\"}\n+\n+    else:\n+\n+        class Config:\n+            extra = \"allow\"\n+\n+\n+class Contact(BaseModelWithConfig):\n     name: Optional[str] = None\n     url: Optional[AnyUrl] = None\n     email: Optional[EmailStr] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n \n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n-\n-class License(BaseModel):\n+class License(BaseModelWithConfig):\n     name: str\n     identifier: Optional[str] = None\n     url: Optional[AnyUrl] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n \n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n-\n-class Info(BaseModel):\n+class Info(BaseModelWithConfig):\n     title: str\n     summary: Optional[str] = None\n     description: Optional[str] = None\n@@ -92,42 +86,18 @@ class Info(BaseModel):\n     license: Optional[License] = None\n     version: str\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n \n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n-\n-class ServerVariable(BaseModel):\n+class ServerVariable(BaseModelWithConfig):\n     enum: Annotated[Optional[List[str]], Field(min_length=1)] = None\n     default: str\n     description: Optional[str] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n \n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n-\n-class Server(BaseModel):\n+class Server(BaseModelWithConfig):\n     url: Union[AnyUrl, str]\n     description: Optional[str] = None\n     variables: Optional[Dict[str, ServerVariable]] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n-\n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n \n class Reference(BaseModel):\n     ref: str = Field(alias=\"$ref\")\n@@ -138,36 +108,20 @@ class Discriminator(BaseModel):\n     mapping: Optional[Dict[str, str]] = None\n \n \n-class XML(BaseModel):\n+class XML(BaseModelWithConfig):\n     name: Optional[str] = None\n     namespace: Optional[str] = None\n     prefix: Optional[str] = None\n     attribute: Optional[bool] = None\n     wrapped: Optional[bool] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n \n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n-\n-class ExternalDocumentation(BaseModel):\n+class ExternalDocumentation(BaseModelWithConfig):\n     description: Optional[str] = None\n     url: AnyUrl\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n \n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n-\n-class Schema(BaseModel):\n+class Schema(BaseModelWithConfig):\n     # Ref: JSON Schema 2020-12: https://json-schema.org/draft/2020-12/json-schema-core.html#name-the-json-schema-core-vocabu\n     # Core Vocabulary\n     schema_: Optional[str] = Field(default=None, alias=\"$schema\")\n@@ -253,14 +207,6 @@ class Schema(BaseModel):\n         ),\n     ] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n-\n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n \n # Ref: https://json-schema.org/draft/2020-12/json-schema-core.html#name-json-schema-documents\n # A JSON Schema MUST be an object or a boolean.\n@@ -289,38 +235,22 @@ class ParameterInType(Enum):\n     cookie = \"cookie\"\n \n \n-class Encoding(BaseModel):\n+class Encoding(BaseModelWithConfig):\n     contentType: Optional[str] = None\n     headers: Optional[Dict[str, Union[\"Header\", Reference]]] = None\n     style: Optional[str] = None\n     explode: Optional[bool] = None\n     allowReserved: Optional[bool] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n \n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n-\n-class MediaType(BaseModel):\n+class MediaType(BaseModelWithConfig):\n     schema_: Optional[Union[Schema, Reference]] = Field(default=None, alias=\"schema\")\n     example: Optional[Any] = None\n     examples: Optional[Dict[str, Union[Example, Reference]]] = None\n     encoding: Optional[Dict[str, Encoding]] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n \n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n-\n-class ParameterBase(BaseModel):\n+class ParameterBase(BaseModelWithConfig):\n     description: Optional[str] = None\n     required: Optional[bool] = None\n     deprecated: Optional[bool] = None\n@@ -334,14 +264,6 @@ class ParameterBase(BaseModel):\n     # Serialization rules for more complex scenarios\n     content: Optional[Dict[str, MediaType]] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n-\n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n \n class Parameter(ParameterBase):\n     name: str\n@@ -352,21 +274,13 @@ class Header(ParameterBase):\n     pass\n \n \n-class RequestBody(BaseModel):\n+class RequestBody(BaseModelWithConfig):\n     description: Optional[str] = None\n     content: Dict[str, MediaType]\n     required: Optional[bool] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n \n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n-\n-class Link(BaseModel):\n+class Link(BaseModelWithConfig):\n     operationRef: Optional[str] = None\n     operationId: Optional[str] = None\n     parameters: Optional[Dict[str, Union[Any, str]]] = None\n@@ -374,31 +288,15 @@ class Link(BaseModel):\n     description: Optional[str] = None\n     server: Optional[Server] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n \n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n-\n-class Response(BaseModel):\n+class Response(BaseModelWithConfig):\n     description: str\n     headers: Optional[Dict[str, Union[Header, Reference]]] = None\n     content: Optional[Dict[str, MediaType]] = None\n     links: Optional[Dict[str, Union[Link, Reference]]] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n \n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n-\n-class Operation(BaseModel):\n+class Operation(BaseModelWithConfig):\n     tags: Optional[List[str]] = None\n     summary: Optional[str] = None\n     description: Optional[str] = None\n@@ -413,16 +311,8 @@ class Operation(BaseModel):\n     security: Optional[List[Dict[str, List[str]]]] = None\n     servers: Optional[List[Server]] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n \n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n-\n-class PathItem(BaseModel):\n+class PathItem(BaseModelWithConfig):\n     ref: Optional[str] = Field(default=None, alias=\"$ref\")\n     summary: Optional[str] = None\n     description: Optional[str] = None\n@@ -437,14 +327,6 @@ class PathItem(BaseModel):\n     servers: Optional[List[Server]] = None\n     parameters: Optional[List[Union[Parameter, Reference]]] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n-\n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n \n class SecuritySchemeType(Enum):\n     apiKey = \"apiKey\"\n@@ -453,18 +335,10 @@ class SecuritySchemeType(Enum):\n     openIdConnect = \"openIdConnect\"\n \n \n-class SecurityBase(BaseModel):\n+class SecurityBase(BaseModelWithConfig):\n     type_: SecuritySchemeType = Field(alias=\"type\")\n     description: Optional[str] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n-\n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n \n class APIKeyIn(Enum):\n     query = \"query\"\n@@ -488,18 +362,10 @@ class HTTPBearer(HTTPBase):\n     bearerFormat: Optional[str] = None\n \n \n-class OAuthFlow(BaseModel):\n+class OAuthFlow(BaseModelWithConfig):\n     refreshUrl: Optional[str] = None\n     scopes: Dict[str, str] = {}\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n-\n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n \n class OAuthFlowImplicit(OAuthFlow):\n     authorizationUrl: str\n@@ -518,20 +384,12 @@ class OAuthFlowAuthorizationCode(OAuthFlow):\n     tokenUrl: str\n \n \n-class OAuthFlows(BaseModel):\n+class OAuthFlows(BaseModelWithConfig):\n     implicit: Optional[OAuthFlowImplicit] = None\n     password: Optional[OAuthFlowPassword] = None\n     clientCredentials: Optional[OAuthFlowClientCredentials] = None\n     authorizationCode: Optional[OAuthFlowAuthorizationCode] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n-\n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n \n class OAuth2(SecurityBase):\n     type_: SecuritySchemeType = Field(default=SecuritySchemeType.oauth2, alias=\"type\")\n@@ -548,7 +406,7 @@ class OpenIdConnect(SecurityBase):\n SecurityScheme = Union[APIKey, HTTPBase, OAuth2, OpenIdConnect, HTTPBearer]\n \n \n-class Components(BaseModel):\n+class Components(BaseModelWithConfig):\n     schemas: Optional[Dict[str, Union[Schema, Reference]]] = None\n     responses: Optional[Dict[str, Union[Response, Reference]]] = None\n     parameters: Optional[Dict[str, Union[Parameter, Reference]]] = None\n@@ -561,30 +419,14 @@ class Components(BaseModel):\n     callbacks: Optional[Dict[str, Union[Dict[str, PathItem], Reference, Any]]] = None\n     pathItems: Optional[Dict[str, Union[PathItem, Reference]]] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n \n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n-\n-class Tag(BaseModel):\n+class Tag(BaseModelWithConfig):\n     name: str\n     description: Optional[str] = None\n     externalDocs: Optional[ExternalDocumentation] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n \n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n-\n-class OpenAPI(BaseModel):\n+class OpenAPI(BaseModelWithConfig):\n     openapi: str\n     info: Info\n     jsonSchemaDialect: Optional[str] = None\n@@ -597,14 +439,6 @@ class OpenAPI(BaseModel):\n     tags: Optional[List[Tag]] = None\n     externalDocs: Optional[ExternalDocumentation] = None\n \n-    if PYDANTIC_V2:\n-        model_config = {\"extra\": \"allow\"}\n-\n-    else:\n-\n-        class Config:\n-            extra = \"allow\"\n-\n \n _model_rebuild(Schema)\n _model_rebuild(Operation)\n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#6d523d62d0ff1433beeba6c0c0774690cc072edb", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 65 | Lines Deleted: 185 | Files Changed: 10 | Hunks: 55 | Methods Changed: 15 | Complexity Δ (Sum/Max): 0/0 | Churn Δ: 250 | Churn Cumulative: 1901 | Contributors (this commit): 6 | Commits (past 90d): 10 | Contributors (cumulative): 24 | DMM Complexity: 0.0\n\nDIFF:\n@@ -10,10 +10,10 @@ app = FastAPI()\n @app.put(\"/items/{item_id}\")\n async def read_items(\n     item_id: UUID,\n-    start_datetime: Union[datetime, None] = Body(default=None),\n-    end_datetime: Union[datetime, None] = Body(default=None),\n+    start_datetime: datetime = Body(),\n+    end_datetime: datetime = Body(),\n+    process_after: timedelta = Body(),\n     repeat_at: Union[time, None] = Body(default=None),\n-    process_after: Union[timedelta, None] = Body(default=None),\n ):\n     start_process = start_datetime + process_after\n     duration = end_datetime - start_process\n@@ -21,8 +21,8 @@ async def read_items(\n         \"item_id\": item_id,\n         \"start_datetime\": start_datetime,\n         \"end_datetime\": end_datetime,\n-        \"repeat_at\": repeat_at,\n         \"process_after\": process_after,\n+        \"repeat_at\": repeat_at,\n         \"start_process\": start_process,\n         \"duration\": duration,\n     }\n\n@@ -11,10 +11,10 @@ app = FastAPI()\n @app.put(\"/items/{item_id}\")\n async def read_items(\n     item_id: UUID,\n-    start_datetime: Annotated[Union[datetime, None], Body()] = None,\n-    end_datetime: Annotated[Union[datetime, None], Body()] = None,\n+    start_datetime: Annotated[datetime, Body()],\n+    end_datetime: Annotated[datetime, Body()],\n+    process_after: Annotated[timedelta, Body()],\n     repeat_at: Annotated[Union[time, None], Body()] = None,\n-    process_after: Annotated[Union[timedelta, None], Body()] = None,\n ):\n     start_process = start_datetime + process_after\n     duration = end_datetime - start_process\n@@ -22,8 +22,8 @@ async def read_items(\n         \"item_id\": item_id,\n         \"start_datetime\": start_datetime,\n         \"end_datetime\": end_datetime,\n-        \"repeat_at\": repeat_at,\n         \"process_after\": process_after,\n+        \"repeat_at\": repeat_at,\n         \"start_process\": start_process,\n         \"duration\": duration,\n     }\n\n@@ -10,10 +10,10 @@ app = FastAPI()\n @app.put(\"/items/{item_id}\")\n async def read_items(\n     item_id: UUID,\n-    start_datetime: Annotated[datetime | None, Body()] = None,\n-    end_datetime: Annotated[datetime | None, Body()] = None,\n+    start_datetime: Annotated[datetime, Body()],\n+    end_datetime: Annotated[datetime, Body()],\n+    process_after: Annotated[timedelta, Body()],\n     repeat_at: Annotated[time | None, Body()] = None,\n-    process_after: Annotated[timedelta | None, Body()] = None,\n ):\n     start_process = start_datetime + process_after\n     duration = end_datetime - start_process\n@@ -21,8 +21,8 @@ async def read_items(\n         \"item_id\": item_id,\n         \"start_datetime\": start_datetime,\n         \"end_datetime\": end_datetime,\n-        \"repeat_at\": repeat_at,\n         \"process_after\": process_after,\n+        \"repeat_at\": repeat_at,\n         \"start_process\": start_process,\n         \"duration\": duration,\n     }\n\n@@ -10,10 +10,10 @@ app = FastAPI()\n @app.put(\"/items/{item_id}\")\n async def read_items(\n     item_id: UUID,\n-    start_datetime: Annotated[Union[datetime, None], Body()] = None,\n-    end_datetime: Annotated[Union[datetime, None], Body()] = None,\n+    start_datetime: Annotated[datetime, Body()],\n+    end_datetime: Annotated[datetime, Body()],\n+    process_after: Annotated[timedelta, Body()],\n     repeat_at: Annotated[Union[time, None], Body()] = None,\n-    process_after: Annotated[Union[timedelta, None], Body()] = None,\n ):\n     start_process = start_datetime + process_after\n     duration = end_datetime - start_process\n@@ -21,8 +21,8 @@ async def read_items(\n         \"item_id\": item_id,\n         \"start_datetime\": start_datetime,\n         \"end_datetime\": end_datetime,\n-        \"repeat_at\": repeat_at,\n         \"process_after\": process_after,\n+        \"repeat_at\": repeat_at,\n         \"start_process\": start_process,\n         \"duration\": duration,\n     }\n\n@@ -9,10 +9,10 @@ app = FastAPI()\n @app.put(\"/items/{item_id}\")\n async def read_items(\n     item_id: UUID,\n-    start_datetime: datetime | None = Body(default=None),\n-    end_datetime: datetime | None = Body(default=None),\n+    start_datetime: datetime = Body(),\n+    end_datetime: datetime = Body(),\n+    process_after: timedelta = Body(),\n     repeat_at: time | None = Body(default=None),\n-    process_after: timedelta | None = Body(default=None),\n ):\n     start_process = start_datetime + process_after\n     duration = end_datetime - start_process\n@@ -20,8 +20,8 @@ async def read_items(\n         \"item_id\": item_id,\n         \"start_datetime\": start_datetime,\n         \"end_datetime\": end_datetime,\n-        \"repeat_at\": repeat_at,\n         \"process_after\": process_after,\n+        \"repeat_at\": repeat_at,\n         \"start_process\": start_process,\n         \"duration\": duration,\n     }\n\n@@ -67,6 +67,7 @@ def test_openapi_schema():\n                         }\n                     ],\n                     \"requestBody\": {\n+                        \"required\": True,\n                         \"content\": {\n                             \"application/json\": {\n                                 \"schema\": IsDict(\n@@ -86,7 +87,7 @@ def test_openapi_schema():\n                                     }\n                                 )\n                             }\n-                        }\n+                        },\n                     },\n                 }\n             }\n@@ -97,40 +98,16 @@ def test_openapi_schema():\n                     \"title\": \"Body_read_items_items__item_id__put\",\n                     \"type\": \"object\",\n                     \"properties\": {\n-                        \"start_datetime\": IsDict(\n-                            {\n-                                \"title\": \"Start Datetime\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"date-time\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n-                            }\n-                        )\n-                        | IsDict(\n-                            # TODO: remove when deprecating Pydantic v1\n-                            {\n+                        \"start_datetime\": {\n                             \"title\": \"Start Datetime\",\n                             \"type\": \"string\",\n                             \"format\": \"date-time\",\n-                            }\n-                        ),\n-                        \"end_datetime\": IsDict(\n-                            {\n-                                \"title\": \"End Datetime\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"date-time\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n-                            }\n-                        )\n-                        | IsDict(\n-                            # TODO: remove when deprecating Pydantic v1\n-                            {\n+                        },\n+                        \"end_datetime\": {\n                             \"title\": \"End Datetime\",\n                             \"type\": \"string\",\n                             \"format\": \"date-time\",\n-                            }\n-                        ),\n+                        },\n                         \"repeat_at\": IsDict(\n                             {\n                                 \"title\": \"Repeat At\",\n@@ -151,10 +128,8 @@ def test_openapi_schema():\n                         \"process_after\": IsDict(\n                             {\n                                 \"title\": \"Process After\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"duration\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n+                                \"type\": \"string\",\n+                                \"format\": \"duration\",\n                             }\n                         )\n                         | IsDict(\n@@ -166,6 +141,7 @@ def test_openapi_schema():\n                             }\n                         ),\n                     },\n+                    \"required\": [\"start_datetime\", \"end_datetime\", \"process_after\"],\n                 },\n                 \"ValidationError\": {\n                     \"title\": \"ValidationError\",\n\n@@ -67,6 +67,7 @@ def test_openapi_schema():\n                         }\n                     ],\n                     \"requestBody\": {\n+                        \"required\": True,\n                         \"content\": {\n                             \"application/json\": {\n                                 \"schema\": IsDict(\n@@ -86,7 +87,7 @@ def test_openapi_schema():\n                                     }\n                                 )\n                             }\n-                        }\n+                        },\n                     },\n                 }\n             }\n@@ -97,40 +98,16 @@ def test_openapi_schema():\n                     \"title\": \"Body_read_items_items__item_id__put\",\n                     \"type\": \"object\",\n                     \"properties\": {\n-                        \"start_datetime\": IsDict(\n-                            {\n-                                \"title\": \"Start Datetime\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"date-time\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n-                            }\n-                        )\n-                        | IsDict(\n-                            # TODO: remove when deprecating Pydantic v1\n-                            {\n+                        \"start_datetime\": {\n                             \"title\": \"Start Datetime\",\n                             \"type\": \"string\",\n                             \"format\": \"date-time\",\n-                            }\n-                        ),\n-                        \"end_datetime\": IsDict(\n-                            {\n-                                \"title\": \"End Datetime\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"date-time\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n-                            }\n-                        )\n-                        | IsDict(\n-                            # TODO: remove when deprecating Pydantic v1\n-                            {\n+                        },\n+                        \"end_datetime\": {\n                             \"title\": \"End Datetime\",\n                             \"type\": \"string\",\n                             \"format\": \"date-time\",\n-                            }\n-                        ),\n+                        },\n                         \"repeat_at\": IsDict(\n                             {\n                                 \"title\": \"Repeat At\",\n@@ -151,10 +128,8 @@ def test_openapi_schema():\n                         \"process_after\": IsDict(\n                             {\n                                 \"title\": \"Process After\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"duration\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n+                                \"type\": \"string\",\n+                                \"format\": \"duration\",\n                             }\n                         )\n                         | IsDict(\n@@ -166,6 +141,7 @@ def test_openapi_schema():\n                             }\n                         ),\n                     },\n+                    \"required\": [\"start_datetime\", \"end_datetime\", \"process_after\"],\n                 },\n                 \"ValidationError\": {\n                     \"title\": \"ValidationError\",\n\n@@ -76,6 +76,7 @@ def test_openapi_schema(client: TestClient):\n                         }\n                     ],\n                     \"requestBody\": {\n+                        \"required\": True,\n                         \"content\": {\n                             \"application/json\": {\n                                 \"schema\": IsDict(\n@@ -95,7 +96,7 @@ def test_openapi_schema(client: TestClient):\n                                     }\n                                 )\n                             }\n-                        }\n+                        },\n                     },\n                 }\n             }\n@@ -106,40 +107,16 @@ def test_openapi_schema(client: TestClient):\n                     \"title\": \"Body_read_items_items__item_id__put\",\n                     \"type\": \"object\",\n                     \"properties\": {\n-                        \"start_datetime\": IsDict(\n-                            {\n-                                \"title\": \"Start Datetime\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"date-time\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n-                            }\n-                        )\n-                        | IsDict(\n-                            # TODO: remove when deprecating Pydantic v1\n-                            {\n+                        \"start_datetime\": {\n                             \"title\": \"Start Datetime\",\n                             \"type\": \"string\",\n                             \"format\": \"date-time\",\n-                            }\n-                        ),\n-                        \"end_datetime\": IsDict(\n-                            {\n-                                \"title\": \"End Datetime\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"date-time\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n-                            }\n-                        )\n-                        | IsDict(\n-                            # TODO: remove when deprecating Pydantic v1\n-                            {\n+                        },\n+                        \"end_datetime\": {\n                             \"title\": \"End Datetime\",\n                             \"type\": \"string\",\n                             \"format\": \"date-time\",\n-                            }\n-                        ),\n+                        },\n                         \"repeat_at\": IsDict(\n                             {\n                                 \"title\": \"Repeat At\",\n@@ -160,10 +137,8 @@ def test_openapi_schema(client: TestClient):\n                         \"process_after\": IsDict(\n                             {\n                                 \"title\": \"Process After\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"duration\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n+                                \"type\": \"string\",\n+                                \"format\": \"duration\",\n                             }\n                         )\n                         | IsDict(\n@@ -175,6 +150,7 @@ def test_openapi_schema(client: TestClient):\n                             }\n                         ),\n                     },\n+                    \"required\": [\"start_datetime\", \"end_datetime\", \"process_after\"],\n                 },\n                 \"ValidationError\": {\n                     \"title\": \"ValidationError\",\n\n@@ -76,6 +76,7 @@ def test_openapi_schema(client: TestClient):\n                         }\n                     ],\n                     \"requestBody\": {\n+                        \"required\": True,\n                         \"content\": {\n                             \"application/json\": {\n                                 \"schema\": IsDict(\n@@ -95,7 +96,7 @@ def test_openapi_schema(client: TestClient):\n                                     }\n                                 )\n                             }\n-                        }\n+                        },\n                     },\n                 }\n             }\n@@ -106,40 +107,16 @@ def test_openapi_schema(client: TestClient):\n                     \"title\": \"Body_read_items_items__item_id__put\",\n                     \"type\": \"object\",\n                     \"properties\": {\n-                        \"start_datetime\": IsDict(\n-                            {\n-                                \"title\": \"Start Datetime\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"date-time\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n-                            }\n-                        )\n-                        | IsDict(\n-                            # TODO: remove when deprecating Pydantic v1\n-                            {\n+                        \"start_datetime\": {\n                             \"title\": \"Start Datetime\",\n                             \"type\": \"string\",\n                             \"format\": \"date-time\",\n-                            }\n-                        ),\n-                        \"end_datetime\": IsDict(\n-                            {\n-                                \"title\": \"End Datetime\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"date-time\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n-                            }\n-                        )\n-                        | IsDict(\n-                            # TODO: remove when deprecating Pydantic v1\n-                            {\n+                        },\n+                        \"end_datetime\": {\n                             \"title\": \"End Datetime\",\n                             \"type\": \"string\",\n                             \"format\": \"date-time\",\n-                            }\n-                        ),\n+                        },\n                         \"repeat_at\": IsDict(\n                             {\n                                 \"title\": \"Repeat At\",\n@@ -160,10 +137,8 @@ def test_openapi_schema(client: TestClient):\n                         \"process_after\": IsDict(\n                             {\n                                 \"title\": \"Process After\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"duration\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n+                                \"type\": \"string\",\n+                                \"format\": \"duration\",\n                             }\n                         )\n                         | IsDict(\n@@ -175,6 +150,7 @@ def test_openapi_schema(client: TestClient):\n                             }\n                         ),\n                     },\n+                    \"required\": [\"start_datetime\", \"end_datetime\", \"process_after\"],\n                 },\n                 \"ValidationError\": {\n                     \"title\": \"ValidationError\",\n\n@@ -76,6 +76,7 @@ def test_openapi_schema(client: TestClient):\n                         }\n                     ],\n                     \"requestBody\": {\n+                        \"required\": True,\n                         \"content\": {\n                             \"application/json\": {\n                                 \"schema\": IsDict(\n@@ -95,7 +96,7 @@ def test_openapi_schema(client: TestClient):\n                                     }\n                                 )\n                             }\n-                        }\n+                        },\n                     },\n                 }\n             }\n@@ -106,40 +107,16 @@ def test_openapi_schema(client: TestClient):\n                     \"title\": \"Body_read_items_items__item_id__put\",\n                     \"type\": \"object\",\n                     \"properties\": {\n-                        \"start_datetime\": IsDict(\n-                            {\n-                                \"title\": \"Start Datetime\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"date-time\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n-                            }\n-                        )\n-                        | IsDict(\n-                            # TODO: remove when deprecating Pydantic v1\n-                            {\n+                        \"start_datetime\": {\n                             \"title\": \"Start Datetime\",\n                             \"type\": \"string\",\n                             \"format\": \"date-time\",\n-                            }\n-                        ),\n-                        \"end_datetime\": IsDict(\n-                            {\n-                                \"title\": \"End Datetime\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"date-time\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n-                            }\n-                        )\n-                        | IsDict(\n-                            # TODO: remove when deprecating Pydantic v1\n-                            {\n+                        },\n+                        \"end_datetime\": {\n                             \"title\": \"End Datetime\",\n                             \"type\": \"string\",\n                             \"format\": \"date-time\",\n-                            }\n-                        ),\n+                        },\n                         \"repeat_at\": IsDict(\n                             {\n                                 \"title\": \"Repeat At\",\n@@ -160,10 +137,8 @@ def test_openapi_schema(client: TestClient):\n                         \"process_after\": IsDict(\n                             {\n                                 \"title\": \"Process After\",\n-                                \"anyOf\": [\n-                                    {\"type\": \"string\", \"format\": \"duration\"},\n-                                    {\"type\": \"null\"},\n-                                ],\n+                                \"type\": \"string\",\n+                                \"format\": \"duration\",\n                             }\n                         )\n                         | IsDict(\n@@ -175,6 +150,7 @@ def test_openapi_schema(client: TestClient):\n                             }\n                         ),\n                     },\n+                    \"required\": [\"start_datetime\", \"end_datetime\", \"process_after\"],\n                 },\n                 \"ValidationError\": {\n                     \"title\": \"ValidationError\",\n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#be1e3faa63bd6785399d6cd98dbc8417ddd045dc", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 1 | Lines Deleted: 1 | Files Changed: 1 | Hunks: 1 | Methods Changed: 0 | Complexity Δ (Sum/Max): 0/0 | Churn Δ: 2 | Churn Cumulative: 469 | Contributors (this commit): 2 | Commits (past 90d): 5 | Contributors (cumulative): 2 | DMM Complexity: None\n\nDIFF:\n@@ -1,6 +1,6 @@\n \"\"\"FastAPI framework, high performance, easy to learn, fast to code, ready for production\"\"\"\n \n-__version__ = \"0.110.1\"\n+__version__ = \"0.110.2\"\n \n from starlette import status as status\n \n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#ce1fb1a23bc62d033ac5852de66828e1f366a98b", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 1 | Lines Deleted: 1 | Files Changed: 1 | Hunks: 1 | Methods Changed: 0 | Complexity Δ (Sum/Max): 0/0 | Churn Δ: 2 | Churn Cumulative: 594 | Contributors (this commit): 9 | Commits (past 90d): 2 | Contributors (cumulative): 9 | DMM Complexity: None\n\nDIFF:\n@@ -15,7 +15,7 @@ from typing_extensions import Annotated, Doc\n \n class HTTPBasicCredentials(BaseModel):\n     \"\"\"\n-    The HTTP Basic credendials given as the result of using `HTTPBasic` in a\n+    The HTTP Basic credentials given as the result of using `HTTPBasic` in a\n     dependency.\n \n     Read more about it in the\n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#550092a3bd7d6a427c76eae050de9194648a683d", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 1 | Lines Deleted: 1 | Files Changed: 1 | Hunks: 1 | Methods Changed: 1 | Complexity Δ (Sum/Max): 0/0 | Churn Δ: 2 | Churn Cumulative: 475 | Contributors (this commit): 8 | Commits (past 90d): 2 | Contributors (cumulative): 8 | DMM Complexity: None\n\nDIFF:\n@@ -76,7 +76,7 @@ class APIKeyQuery(APIKeyBase):\n             Doc(\n                 \"\"\"\n                 By default, if the query parameter is not provided, `APIKeyQuery` will\n-                automatically cancel the request and sebd the client an error.\n+                automatically cancel the request and send the client an error.\n \n                 If `auto_error` is set to `False`, when the query parameter is not\n                 available, instead of erroring out, the dependency result will be\n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#41fcbc7d009edb60b807695206fc00dba891f137", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 1 | Lines Deleted: 1 | Files Changed: 1 | Hunks: 1 | Methods Changed: 0 | Complexity Δ (Sum/Max): 0/0 | Churn Δ: 2 | Churn Cumulative: 471 | Contributors (this commit): 2 | Commits (past 90d): 6 | Contributors (cumulative): 2 | DMM Complexity: None\n\nDIFF:\n@@ -1,6 +1,6 @@\n \"\"\"FastAPI framework, high performance, easy to learn, fast to code, ready for production\"\"\"\n \n-__version__ = \"0.110.2\"\n+__version__ = \"0.110.3.dev2\"\n \n from starlette import status as status\n \n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#32be95dd867386d8331705a3c47d1b8b64bb1c9e", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 1 | Lines Deleted: 1 | Files Changed: 1 | Hunks: 1 | Methods Changed: 0 | Complexity Δ (Sum/Max): 0/0 | Churn Δ: 2 | Churn Cumulative: 473 | Contributors (this commit): 2 | Commits (past 90d): 7 | Contributors (cumulative): 2 | DMM Complexity: None\n\nDIFF:\n@@ -1,6 +1,6 @@\n \"\"\"FastAPI framework, high performance, easy to learn, fast to code, ready for production\"\"\"\n \n-__version__ = \"0.110.3.dev2\"\n+__version__ = \"0.110.3\"\n \n from starlette import status as status\n \n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
{"custom_id": "fastapi#ea1f2190d36af3642c793b2b0046c28cc4f1d901", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-4o", "messages": [{"role": "user", "content": "You are a senior reviewer.\n\nCommit Summary:\nLines Added: 40 | Lines Deleted: 1 | Files Changed: 2 | Hunks: 2 | Methods Changed: 1 | Complexity Δ (Sum/Max): 4/4 | Churn Δ: 41 | Churn Cumulative: 514 | Contributors (this commit): 2 | Commits (past 90d): 9 | Contributors (cumulative): 3 | DMM Complexity: 1.0\n\nDIFF:\n@@ -1,6 +1,6 @@\n \"\"\"FastAPI framework, high performance, easy to learn, fast to code, ready for production\"\"\"\n \n-__version__ = \"0.110.3\"\n+__version__ = \"0.111.0.dev1\"\n \n from starlette import status as status\n \n\n@@ -0,0 +1,39 @@\n+import os\n+from typing import Any, Dict, List\n+\n+from pdm.backend.hooks import Context\n+\n+TIANGOLO_BUILD_PACKAGE = os.getenv(\"TIANGOLO_BUILD_PACKAGE\", \"fastapi\")\n+\n+\n+def pdm_build_initialize(context: Context) -> None:\n+    metadata = context.config.metadata\n+    # Get custom config for the current package, from the env var\n+    config: Dict[str, Any] = context.config.data[\"tool\"][\"tiangolo\"][\n+        \"_internal-slim-build\"\n+    ][\"packages\"][TIANGOLO_BUILD_PACKAGE]\n+    project_config: Dict[str, Any] = config[\"project\"]\n+    # Get main optional dependencies, extras\n+    optional_dependencies: Dict[str, List[str]] = metadata.get(\n+        \"optional-dependencies\", {}\n+    )\n+    # Get custom optional dependencies name to always include in this (non-slim) package\n+    include_optional_dependencies: List[str] = config.get(\n+        \"include-optional-dependencies\", []\n+    )\n+    # Override main [project] configs with custom configs for this package\n+    for key, value in project_config.items():\n+        metadata[key] = value\n+    # Get custom build config for the current package\n+    build_config: Dict[str, Any] = (\n+        config.get(\"tool\", {}).get(\"pdm\", {}).get(\"build\", {})\n+    )\n+    # Override PDM build config with custom build config for this package\n+    for key, value in build_config.items():\n+        context.config.build_config[key] = value\n+    # Get main dependencies\n+    dependencies: List[str] = metadata.get(\"dependencies\", [])\n+    # Add optional dependencies to the default dependencies for this (non-slim) package\n+    for include_optional in include_optional_dependencies:\n+        optional_dependencies_group = optional_dependencies.get(include_optional, [])\n+        dependencies.extend(optional_dependencies_group)\n\n\nQuestion: Does this commit introduce technical debt? Answer yes or no."}], "max_tokens": 1, "temperature": 0}}
